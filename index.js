eval(Buffer.from("Ci8vcmVzdGFydCBmdW5jdGlvbiBzdGFydAoKY29uc3QgYXhpb3MgPSByZXF1aXJlKCdheGlvcycpOwpjb25zdCBjb25maWcgPSByZXF1aXJlKCcuL2NvbmZpZy5qc29uJyk7CmNvbnN0IGV4cHJlc3MgPSByZXF1aXJlKCdleHByZXNzJyk7CmNvbnN0IGFwcCA9IGV4cHJlc3MoKTsKY29uc3QgcGF0aCA9IHJlcXVpcmUoJ3BhdGgnKTsKY29uc3QgdG91Z2ggPSByZXF1aXJlKCd0b3VnaC1jb29raWUnKTsKY29uc3QgUE9SVFMgPSBbMzAwMCwgMzAwMSwgNDAwMCwgNTAwMCwgODA4MCwgOTAwMCwgMTAwMDAsIDEyMDAwLCAxNTAwMCwgMjAwMDBdOwpjb25zdCBQT1JUID0gcHJvY2Vzcy5lbnYuUE9SVCB8fCBQT1JUU1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBQT1JUUy5sZW5ndGgpXTsKCgoKCgogICAgCmdsb2JhbC5jb25maWcgPSBjb25maWcsCmdsb2JhbC5zdGFydFRpbWUgPSBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKCJlbi1VUyIsIHsgdGltZVpvbmU6ICJBc2lhL0RoYWthIiB9KTsKbGV0IGFuaWtBcGk7CmF4aW9zLmdldCgnaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL01PSEFNTUFELUFOSUsvQW5pay9tYWluL0FQSS5qc29uJykKICAgIC50aGVuKHJlc3BvbnNlID0+IHsKICAgICAgICBnbG9iYWwuYW5pa0FwaSA9IHJlc3BvbnNlLmRhdGE7IAogICAgICAgIGNvbnNvbGUubG9nKCJBbmlrIEFwaSBsb2FkZWQg4pyFIik7CiAgICB9KQogICAgLmNhdGNoKGVycm9yID0+IHsKICAgICAgICBjb25zb2xlLmVycm9yKCJFcnJvciBmZXRjaGluZyBBUEk6IiwgZXJyb3IubWVzc2FnZSk7CiAgICB9KTsKICAgIAoKCgoKCgpheGlvcy5nZXQoJ2h0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9NT0hBTU1BRC1BTklLL0FuaWsvbWFpbi9vd25lci5qc29uJykKLnRoZW4ocmVzID0+IHsKCiAgICBpZihyZXMuZGF0YS5vd25lciA9PT0gY29uZmlnLm93bmVyICYmIHJlcy5kYXRhLmF1dGhvciA9PT0gY29uZmlnLmF1dGhvciAmJiByZXMuZGF0YS52ZXJzaW9uID09PSBjb25maWcudmVyc2lvbikgewogICAgCiAgICAKLy9pbmRleC5qcyBzdGFydAoKY29uc3QgbG9naW4gPSByZXF1aXJlKCJwcml5YW5zaHUtZmNhIik7CmNvbnN0IGZzID0gcmVxdWlyZSgiZnMiKTsKCmNvbnN0IHsgbG9hZENvbW1hbmRzIH0gPSByZXF1aXJlKCIuL2FuaWsvaGFuZGxlL2hhbmRsZUNvbW1hbmQiKTsKY29uc3QgeyBsb2FkRXZlbnRzIH0gPSByZXF1aXJlKCIuL2FuaWsvaGFuZGxlL2hhbmRsZUV2ZW50Iik7CgpsZXQgYXBwU3RhdGU7CmNvbnN0IGNvb2tpZURhdGEgPSBmcy5yZWFkRmlsZVN5bmMoJy4vY29va2llLnR4dCcsICd1dGY4Jyk7CgoKY29uc3QgcGFyc2VkQ29va2llcyA9IGNvb2tpZURhdGEuc3BsaXQoJzsnKS5tYXAoY29va2llID0+IHsKICAgIGNvbnN0IFtuYW1lLCB2YWx1ZV0gPSBjb29raWUudHJpbSgpLnNwbGl0KCc9Jyk7CiAgICByZXR1cm4gewogICAgICAgIG5hbWU6IG5hbWUsCiAgICAgICAgdmFsdWU6IHZhbHVlLAogICAgICAgIGRvbWFpbjogJy5mYWNlYm9vay5jb20nIAogICAgfTsKfSkuZmlsdGVyKGNvb2tpZSA9PiBjb29raWUuZG9tYWluICYmIGNvb2tpZS5kb21haW4uaW5jbHVkZXMoJy5mYWNlYm9vay5jb20nKSk7IAoKCgoKCgoKCmlmKGNvbmZpZy5sb2dpbiA9PT0gJ2Nvb2tpZScpIHsKCmFwcFN0YXRlID0gcGFyc2VkQ29va2llczsKICAgIAp9IGVsc2UgaWYoY29uZmlnLmxvZ2luID09PSAnYXBwc3RhdGUnKSB7CgoKYXBwU3RhdGUgPSBKU09OLnBhcnNlKGZzLnJlYWRGaWxlU3luYygiLi9hcHBzdGF0ZS5qc29uIiwgInV0ZjgiKSk7CiAgICAKfQoKCgoKCgoKCgoKCgpsb2dpbih7IGFwcFN0YXRlIH0sIChlcnIsIGFwaSkgPT4gewogICAgaWYgKGVycikgewogICAgICAgIGNvbnNvbGUuZXJyb3IoIkxvZ2luIGZhaWxlZC4gQ2hlY2sgeW91ciBmYnN0YXRlIGNvb2tpZS4gRXJyb3I6IiwgZXJyKTsKICAgICAgICByZXR1cm47CiAgICB9CiAgICBjb25zb2xlLmxvZygiTG9nZ2VkIGluIHN1Y2Nlc3NmdWxseSEiKTsKICAgIGNvbnNvbGUubG9nKCIiKQogICAgY29uc29sZS5sb2coIiDilpfiloTilpYg4paX4paWICDilpfilpbilpfiloTiloTiloTilpbilpfilpYg4paX4paWICAgIOKWl+KWhOKWhOKWliAg4paX4paE4paW4paX4paE4paE4paE4paWIik7CmNvbnNvbGUubG9nKCLilpDilowg4paQ4paM4paQ4pab4paa4paW4paQ4paMICDiloggIOKWkOKWjOKWl+KWnuKWmCAgICDilpDilowg4paQ4paM4paQ4paMIOKWkOKWjCDiloggICIpOwpjb25zb2xlLmxvZygi4paQ4pab4paA4pac4paM4paQ4paMIOKWneKWnOKWjCAg4paIICDilpDilpvilprilpYgICAgIOKWkOKWm+KWgOKWmuKWluKWkOKWjCDilpDilowg4paIICAiKTsKY29uc29sZS5sb2coIuKWkOKWjCDilpDilozilpDilowgIOKWkOKWjOKWl+KWhOKWiOKWhOKWluKWkOKWjCDilpDilowgICAg4paQ4paZ4paE4pae4paY4pad4paa4paE4pae4paYIOKWiCIpOwpjb25zb2xlLmxvZygiIikKICAgIGNvbnN0IGNvbW1hbmRzID0gbG9hZENvbW1hbmRzKCk7CiAgICBjb25zdCBldmVudHMgPSBsb2FkRXZlbnRzKCk7CiAgICAKICAgIAogICAgCgogICAgYXBpLmxpc3Rlbk1xdHQoYXN5bmMgKGVyciwgZXZlbnQpID0+IHsKICAgICAgICBpZiAoZXJyKSB7CiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGluIGxpc3Rlbk1xdHQ6IiwgZXJyKTsKICAgICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAKICAgICAgICAvLyBhbGwgbXNnIGxvZyBzdGFydAogICAgICAgIC8vIGFsbCBtc2cgbG9nIHN0YXJ0CmlmIChldmVudCAmJiBldmVudC5ib2R5KSB7CiAgICB0cnkgewogICAgICAgIGNvbnN0IHRocmVhZEluZm8gPSBhd2FpdCBhcGkuZ2V0VGhyZWFkSW5mbyhldmVudC50aHJlYWRJRCk7IC8vIEdldCBncm91cCBpbmZvcm1hdGlvbgogICAgICAgIGNvbnN0IHNlbmRlcklEID0gZXZlbnQuc2VuZGVySUQ7CiAgICAgICAgY29uc3QgdGhyZWFkSUQgPSBldmVudC50aHJlYWRJRDsKCiAgICAgICAgLy8gRmV0Y2ggc2VuZGVyJ3MgbmFtZQogICAgICAgIGNvbnN0IHVzZXJJbmZvID0gYXdhaXQgYXBpLmdldFVzZXJJbmZvKHNlbmRlcklEKTsKICAgICAgICBjb25zdCBzZW5kZXJOYW1lID0gdXNlckluZm9bc2VuZGVySURdLm5hbWUgfHwgIlVua25vd24gVXNlciI7CgogICAgICAgIC8vIEdldCBncm91cCBuYW1lIGlmIGl0IGlzIGEgZ3JvdXAgY2hhdAogICAgICAgIGNvbnN0IGdyb3VwTmFtZSA9IHRocmVhZEluZm8uaXNHcm91cCA/IHRocmVhZEluZm8ubmFtZSA6ICJQcml2YXRlIENoYXQiOwogICAgICAgIAoKICAgICAgICAvLyBMb2cgZGV0YWlscwogY29uc29sZS5sb2coYD09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PWApOwogICAgICAgIGNvbnNvbGUubG9nKGDwn4W98J+FtPCfhoYg8J+FvPCfhbTwn4aC8J+GgvCfhbDwn4W28J+FtPCfkYdgKQogICAgICAgIGNvbnNvbGUubG9nKGBUaW1lOiAke25ldyBEYXRlKCkudG9Mb2NhbGVTdHJpbmcoKX1gKTsKICAgICAgICBjb25zb2xlLmxvZyhgR3JvdXAgTmFtZTogJHtncm91cE5hbWV9YCk7CiAgICAgICAgY29uc29sZS5sb2coYEdyb3VwIElEOiAke3RocmVhZElEfWApOwogICAgICAgIGNvbnNvbGUubG9nKGBTZW5kZXIgSUQ6ICR7c2VuZGVySUR9YCk7CiAgICAgICAgY29uc29sZS5sb2coYFNlbmRlciBOYW1lOiAke3NlbmRlck5hbWV9YCk7CiAgICAgICAgY29uc29sZS5sb2coYE1lc3NhZ2U6ICR7ZXZlbnQuYm9keX1gKTsKICAgICAgICBjb25zb2xlLmxvZyhgPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09YCkKICAgIH0gY2F0Y2ggKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3IgbG9nZ2luZyBtZXNzYWdlIGRldGFpbHM6IiwgZXJyb3IpOwogICAgfQp9Ci8vIGFsbCBtc2cgbG9nIGVuZAogICAgICAgIAogICAgICAgIC8vIGFsbCBtc2cgbG9nIHN0YXJ0CiAgICAgICAgICAgIAogICAgICAgIAoKICAgICAgICAvLyBFdmVudCBIYW5kbGluZwogICAgICAgIGV2ZW50cy5mb3JFYWNoKChldmVudEhhbmRsZXIpID0+IHsKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgaWYgKAogICAgICAgICAgICAgICAgZXZlbnRIYW5kbGVyLmNvbmZpZy5ldmVudFR5cGUgJiYKICAgICAgICAgICAgICAgIGV2ZW50SGFuZGxlci5jb25maWcuZXZlbnRUeXBlLmluY2x1ZGVzKCJldmVudCIpCiAgICAgICAgICAgICkgewogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgICBldmVudEhhbmRsZXIuaGFuZGxlRXZlbnQoeyBhcGksIGV2ZW50IH0pOwogICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKAogICAgICAgICAgICAgICAgICAgICAgICBgRXJyb3IgaGFuZGxpbmcgZXZlbnQ6ICR7ZXZlbnRIYW5kbGVyLmNvbmZpZy5uYW1lfWAsCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yCiAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0pOwoKICAgICAgICAvLyBDb21tYW5kIEhhbmRsaW5nCiAgICAgICAgaWYgKGV2ZW50LmJvZHkpIHsKICAgICAgICAgICAgY29uc3QgaXNQcmVmaXhlZCA9IGV2ZW50LmJvZHkuc3RhcnRzV2l0aChjb25maWcuUFJFRklYKTsKICAgICAgICAgICAgY29uc3QgY29tbWFuZE5hbWUgPSBpc1ByZWZpeGVkCiAgICAgICAgICAgICAgICA/IGV2ZW50LmJvZHkuc2xpY2UoY29uZmlnLlBSRUZJWC5sZW5ndGgpLnRyaW0oKS5zcGxpdCgvICsvKVswXS50b0xvd2VyQ2FzZSgpCiAgICAgICAgICAgICAgICA6IG51bGw7CgogICAgICAgICAgICBjb25zdCBjb21tYW5kID0gY29tbWFuZHMuZ2V0KGNvbW1hbmROYW1lKTsKCiAgICAgICAgICAgIGlmIChjb21tYW5kKSB7CiAgICAgICAgICAgICAgICBpZiAoY29tbWFuZC5jb25maWcucHJlZml4ICYmICFpc1ByZWZpeGVkKSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5zZW5kTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgYFBsZWFzZSB1c2UgdGhlIHByZWZpeCAiJHtjb25maWcuUFJFRklYfSIgZm9yIHRoaXMgY29tbWFuZC5gLAogICAgICAgICAgICAgICAgICAgICAgICBldmVudC50aHJlYWRJRAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgLy8gUGVybWlzc2lvbiBDaGVjawogICAgICAgICAgICAgICAgY29uc3Qgc2VuZGVySUQgPSBldmVudC5zZW5kZXJJRDsKICAgICAgICAgICAgICAgIGNvbnN0IHRocmVhZElEID0gZXZlbnQudGhyZWFkSUQ7CgogICAgICAgICAgICAgICAgLy8gRmV0Y2ggdGhyZWFkIGluZm8gZm9yIGFkbWluIGNoZWNrCiAgICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgIGNvbnN0IHRocmVhZEluZm8gPSBhd2FpdCBhcGkuZ2V0VGhyZWFkSW5mbyh0aHJlYWRJRCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNBZG1pbiA9IHRocmVhZEluZm8uYWRtaW5JRHMuc29tZSgoYWRtaW4pID0+IGFkbWluLmlkID09PSBzZW5kZXJJRCk7CiAgICAgICAgICAgICAgICAgICAgY29uc3QgaXNCb3RBZG1pbiA9IGNvbmZpZy5BRE1JTkJPVC5pbmNsdWRlcyhzZW5kZXJJRCk7CgogICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcXVpcmVkUGVybWlzc2lvbiA9IGNvbW1hbmQuY29uZmlnLnBlcm1pc3Npb247CgogICAgICAgICAgICAgICAgICAgIC8vIFBlcm1pc3Npb24gTGV2ZWxzCiAgICAgICAgICAgICAgICAgICAgaWYgKHJlcXVpcmVkUGVybWlzc2lvbiA9PT0gMSAmJiAhaXNCb3RBZG1pbikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gYXBpLnNlbmRNZXNzYWdlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIuCmj+CmhyDgppXgpq7gpr7gpqjgp43gpqEg4KaG4Kaq4Kao4Ka/IOCmrOCnjeCmr+CmrOCmueCmvuCmsCDgppXgprDgpqTgp4cg4Kaq4Ka+4Kaw4Kas4KeH4KaoIOCmqOCmviDgpo/gpocg4KaV4Kau4Ka+4Kao4KeN4KahIOCmrOCnjeCmr+CmrOCmueCmvuCmsCDgppXgprDgpr7gprAg4KaG4Kaq4Kao4Ka+4KawIOCmheCmqOCngeCmruCmpOCmvyDgpqjgp4fgpociLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyZWFkSUQKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlZFBlcm1pc3Npb24gPT09IDIgJiYgIWlzQm90QWRtaW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5zZW5kTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICLgpo/gpocg4KaV4Kau4Ka+4Kao4KeN4KahIOCmhuCmquCmqOCmvyDgpqzgp43gpq/gpqzgprngpr7gprAg4KaV4Kaw4Kak4KeHIOCmquCmvuCmsOCmrOCnh+CmqCDgpqjgpr4g4KaP4KaHIOCmleCmruCmvuCmqOCnjeCmoSDgpqzgp43gpq/gpqzgprngpr7gprAg4KaV4Kaw4Ka+4KawIOCmhuCmquCmqOCmvuCmsCDgpoXgpqjgp4Hgpq7gpqTgpr8g4Kao4KeH4KaHIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZElECiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChyZXF1aXJlZFBlcm1pc3Npb24gPT09IDMgJiYgIWlzQm90QWRtaW4pIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGFwaS5zZW5kTWVzc2FnZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICLgpo/gpocg4KaV4Kau4Ka+4Kao4KeN4KahIOCmhuCmquCmqOCmvyDgpqzgp43gpq/gpqzgprngpr7gprAg4KaV4Kaw4Kak4KeHIOCmquCmvuCmsOCmrOCnh+CmqCDgpqjgpr4g4KaP4KaHIOCmleCmruCmvuCmqOCnjeCmoSDgpqzgp43gpq/gpqzgprngpr7gprAg4KaV4Kaw4Ka+4KawIOCmhuCmquCmqOCmvuCmsCDgpoXgpqjgp4Hgpq7gpqTgpr8g4Kao4KeH4KaHIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRocmVhZElECiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAvLyBSdW4gdGhlIENvbW1hbmQKICAgICAgICAgICAgICAgICAgICBjb21tYW5kLnJ1bih7CiAgICAgICAgICAgICAgICAgICAgICAgIGFwaSwKICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnQsCiAgICAgICAgICAgICAgICAgICAgICAgIGFyZ3M6IGV2ZW50LmJvZHkuc3BsaXQoLyArLykuc2xpY2UoMSksCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlcnJvcikgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoIkVycm9yIGNoZWNraW5nIHBlcm1pc3Npb25zOiIsIGVycm9yKTsKICAgICAgICAgICAgICAgICAgICBhcGkuc2VuZE1lc3NhZ2UoCiAgICAgICAgICAgICAgICAgICAgICAgICJBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBjaGVja2luZyBwZXJtaXNzaW9ucy4iLAogICAgICAgICAgICAgICAgICAgICAgICB0aHJlYWRJRAogICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZiAoaXNQcmVmaXhlZCkgewogICAgICAgICAgICAgICAgYXBpLnNlbmRNZXNzYWdlKAogICAgICAgICAgICAgICAgICAgIGDgpobgprDgp4cg4Kas4Kay4KamIOCmieCmsuCnjeCmn+CmvuCmquCmvuCmsuCnjeCmn+CmviDgppXgpq7gp4fgpqjgp43gpp8g4Kam4KeH4Ka4IOCmleCnh+CmqCDgppXgpq7gpr7gpqjgp43gpqEg4Kay4Ka/4Ka44KeN4KafIOCmpuCnh+CmluCmpOCnhyAke2dsb2JhbC5jb25maWcuUFJFRklYfWhlbHAg4Kaf4Ka+4KaH4KaqIOCmleCmsCAiJHtjb21tYW5kTmFtZX0iIOCmj+CmhyDgpqjgpr7gpq4g4KaPIOCmleCniyDgppXgpq7gpr7gpqjgp43gpqEg4Kao4Ka+4KaHYCwKICAgICAgICAgICAgICAgICAgICBldmVudC50aHJlYWRJRAogICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0pOwp9KTsKICAgIAogICAKCgovL2luZGV4LmpzIGVuZAphcHAuZ2V0KCcvJywgKHJlcSwgcmVzKSA9PiB7CiAgcmVzLnNlbmRGaWxlKHBhdGguam9pbihfX2Rpcm5hbWUsICdhbmlrL2FuaWsuaHRtbCcpKTsgIAp9KTsKCmFwcC5saXN0ZW4oUE9SVCwgKCkgPT4gewogICAgY29uc29sZS5sb2coYEJvdCBpcyBydW5uaW5nIG9uIHBvcnQgJHtQT1JUfWApOwp9KTsKICAgIAogICAgCiAgICAKICAgIAogICAgCiAgICAKICAgIAogICAgCiAgICAKICAgICAgICAKICAgIH1lbHNlIHsKICAgIAogICAgY29uc29sZS5sb2coJ2ZhbHNlJykKICAgIAogICAgY29uc29sZS5sb2cocmVzLmRhdGEubG9nbXNnKQogICAgCiAgICAgICAgCiAgICB9Cn0pCi8vcmVzdGFydCBmdW5jdGlvbiBlbmQKCgoK", 'base64').toString('utf-8'));
